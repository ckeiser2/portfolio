(()=>{"use strict";function t(t){const e=new Window_Base(new Rectangle),i=e.textSizeEx(t);e.padding=0,e.move(0,0,i.width,i.height),e.createContents(),e.drawTextEx(t,0,0,0);const p=e.contents;return e.contents=null,e.destroy(),p.mzkp_isTextPicture=!0,p}function e(t){t&&t.mzkp_isTextPicture&&t.destroy()}const i="TextPicture";let p="";PluginManager.registerCommand(i,"set",t=>{p=String(t.text)});const s=Game_Picture.prototype.show;Game_Picture.prototype.show=function(){s.apply(this,arguments),""===this._name&&p&&(this.mzkp_text=p,this.mzkp_textChanged=!0,p="")};const n=Sprite_Picture.prototype.destroy;Sprite_Picture.prototype.destroy=function(){e(this.bitmap),n.apply(this,arguments)};const o=Sprite_Picture.prototype.updateBitmap;Sprite_Picture.prototype.updateBitmap=function(){if(o.apply(this,arguments),this.visible&&""===this._pictureName){const i=this.picture(),p=i&&i.mzkp_text||"",s=i&&i.mzkp_textChanged;(this.mzkp_text!==p||s)&&(this.mzkp_text=p,e(this.bitmap),this.bitmap=t(p),i.mzkp_textChanged=!1)}else this.mzkp_text=""}})();