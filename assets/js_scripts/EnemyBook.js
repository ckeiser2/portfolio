!function(){function t(){this.initialize.apply(this,arguments)}function e(){this.initialize.apply(this,arguments)}function i(){this.initialize.apply(this,arguments)}var o=PluginManager.parameters("EnemyBook"),s=String(o["Unknown Data"]||"??????"),n=Game_Interpreter.prototype.pluginCommand;Game_Interpreter.prototype.pluginCommand=function(e,i){if(n.call(this,e,i),"EnemyBook"===e)switch(i[0]){case"open":SceneManager.push(t);break;case"add":$gameSystem.addToEnemyBook(Number(i[1]));break;case"remove":$gameSystem.removeFromEnemyBook(Number(i[1]));break;case"complete":$gameSystem.completeEnemyBook();break;case"clear":$gameSystem.clearEnemyBook()}},Game_System.prototype.addToEnemyBook=function(t){this._enemyBookFlags||this.clearEnemyBook(),this._enemyBookFlags[t]=!0},Game_System.prototype.removeFromEnemyBook=function(t){this._enemyBookFlags&&(this._enemyBookFlags[t]=!1)},Game_System.prototype.completeEnemyBook=function(){this.clearEnemyBook();for(var t=1;t<$dataEnemies.length;t++)this._enemyBookFlags[t]=!0},Game_System.prototype.clearEnemyBook=function(){this._enemyBookFlags=[]},Game_System.prototype.isInEnemyBook=function(t){return!(!this._enemyBookFlags||!t)&&!!this._enemyBookFlags[t.id]};var a=Game_Troop.prototype.setup;Game_Troop.prototype.setup=function(t){a.call(this,t),this.members().forEach(function(t){t.isAppeared()&&$gameSystem.addToEnemyBook(t.enemyId())},this)};var r=Game_Enemy.prototype.appear;Game_Enemy.prototype.appear=function(){r.call(this),$gameSystem.addToEnemyBook(this._enemyId)};var p=Game_Enemy.prototype.transform;Game_Enemy.prototype.transform=function(t){p.call(this,t),$gameSystem.addToEnemyBook(t)},t.prototype=Object.create(Scene_MenuBase.prototype),t.prototype.constructor=t,t.prototype.initialize=function(){Scene_MenuBase.prototype.initialize.call(this)},t.prototype.create=function(){Scene_MenuBase.prototype.create.call(this),this._indexWindow=new e(0,0),this._indexWindow.setHandler("cancel",this.popScene.bind(this));var t=this._indexWindow.height,o=Graphics.boxWidth,s=Graphics.boxHeight-t;this._statusWindow=new i(0,t,o,s),this.addWindow(this._indexWindow),this.addWindow(this._statusWindow),this._indexWindow.setStatusWindow(this._statusWindow)},e.prototype=Object.create(Window_Selectable.prototype),e.prototype.constructor=e,e.lastTopRow=0,e.lastIndex=0,e.prototype.initialize=function(t,i){var o=Graphics.boxWidth,s=this.fittingHeight(6);Window_Selectable.prototype.initialize.call(this,t,i,o,s),this.refresh(),this.setTopRow(e.lastTopRow),this.select(e.lastIndex),this.activate()},e.prototype.maxCols=function(){return 3},e.prototype.maxItems=function(){return this._list?this._list.length:0},e.prototype.setStatusWindow=function(t){this._statusWindow=t,this.updateStatus()},e.prototype.update=function(){Window_Selectable.prototype.update.call(this),this.updateStatus()},e.prototype.updateStatus=function(){if(this._statusWindow){var t=this._list[this.index()];this._statusWindow.setEnemy(t)}},e.prototype.refresh=function(){this._list=[];for(var t=1;t<$dataEnemies.length;t++){var e=$dataEnemies[t];e.name&&"no"!==e.meta.book&&this._list.push(e)}this.createContents(),this.drawAllItems()},e.prototype.drawItem=function(t){var e,i=this._list[t],o=this.itemRectForText(t);e=$gameSystem.isInEnemyBook(i)?i.name:s,this.drawText(e,o.x,o.y,o.width)},e.prototype.processCancel=function(){Window_Selectable.prototype.processCancel.call(this),e.lastTopRow=this.topRow(),e.lastIndex=this.index()},i.prototype=Object.create(Window_Base.prototype),i.prototype.constructor=i,i.prototype.initialize=function(t,e,i,o){Window_Base.prototype.initialize.call(this,t,e,i,o),this._enemy=null,this._enemySprite=new Sprite,this._enemySprite.anchor.x=.5,this._enemySprite.anchor.y=.5,this._enemySprite.x=i/2-20,this._enemySprite.y=o/2,this.addChildToBack(this._enemySprite),this.refresh()},i.prototype.setEnemy=function(t){this._enemy!==t&&(this._enemy=t,this.refresh())},i.prototype.update=function(){if(Window_Base.prototype.update.call(this),this._enemySprite.bitmap){var t=this._enemySprite.bitmap.height,e=this.contents.height,i=1;t>e&&(i=e/t),this._enemySprite.scale.x=i,this._enemySprite.scale.y=i}},i.prototype.refresh=function(){var t=this._enemy,e=0,i=0,o=this.lineHeight();if(this.contents.clear(),t&&$gameSystem.isInEnemyBook(t)){var s,n=t.battlerName,a=t.battlerHue;s=$gameSystem.isSideView()?ImageManager.loadSvEnemy(n,a):ImageManager.loadEnemy(n,a),this._enemySprite.bitmap=s,this.resetTextColor(),this.drawText(t.name,e,i),e=this.textPadding(),i=o+this.textPadding();for(var r=0;r<8;r++)this.changeTextColor(this.systemColor()),this.drawText(TextManager.param(r),e,i,160),this.resetTextColor(),this.drawText(t.params[r],e+160,i,60,"right"),i+=o;var p=280;e=this.contents.width-p,i=o+this.textPadding(),this.resetTextColor(),this.drawText(t.exp,e,i),e+=this.textWidth(t.exp)+6,this.changeTextColor(this.systemColor()),this.drawText(TextManager.expA,e,i),e+=this.textWidth(TextManager.expA+"  "),this.resetTextColor(),this.drawText(t.gold,e,i),e+=this.textWidth(t.gold)+6,this.changeTextColor(this.systemColor()),this.drawText(TextManager.currencyUnit,e,i),e=this.contents.width-p,i+=o;for(var h=0;h<t.dropItems.length;h++){var m=t.dropItems[h];if(m.kind>0){var y=Game_Enemy.prototype.itemObject(m.kind,m.dataId);this.drawItemName(y,e,i,p),i+=o}}var d=480;e=this.contents.width-d,i=this.textPadding()+7*o,this.drawTextEx(t.meta.desc1,e,i+0*o,d),this.drawTextEx(t.meta.desc2,e,i+1*o,d)}else this._enemySprite.bitmap=null}}();